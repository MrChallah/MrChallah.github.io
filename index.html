<!DOCTYPE html><html><head><meta charset="utf-8">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
html,body{margin:0;padding:0;background:transparent;color:#fff;font-family:sans-serif;}
#info{position:absolute;top:8px;left:8px;display:flex;flex-direction:column;gap:4px;}
.row{display:flex;align-items:center;font-size:15px;font-weight:500;text-shadow:0 0 4px #000,0 0 8px #000;}
.row i{width:18px;margin-right:6px;text-align:center;}
</style></head><body>

<div id="info">
  <div class="row"><i class="fa-regular fa-clock"></i><span id="time">--:--:--</span></div>
  <div class="row"><i class="fa-solid fa-location-dot"></i><span id="place">Waiting…</span></div>
  <div class="row"><i class="fa-solid fa-cloud"></i><span id="weather">--°C</span></div>
</div>

<script>
const placeEl = document.getElementById('place');
const weatherEl = document.getElementById('weather');
const OWM_KEY = '618628ae452ff89f0e4477fba20b9d5c'; // Your OpenWeatherMap key

function tick(){
  const now = new Date();
  const offset = now.getTimezoneOffset() / -60;
  const sign = offset > 0 ? '-' : '+';
  document.getElementById('time').textContent =
    `${now.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',second:'2-digit'})} GMT${sign}${Math.abs(offset)}`;
}
tick(); setInterval(tick, 1000);

async function reverseGeocode(lat, lon){
  const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&accept-language=en`);
  const geo = await res.json();
  const addr = geo.address;
  const parts = [
    addr.road || addr.suburb || "",
    addr.city || addr.town || addr.village || "",
    addr.state || "",
    addr.country || ""
  ].filter(Boolean);
  return parts.join(", ");
}

async function fetchWeather(lat, lon){
  const r = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=en&appid=${OWM_KEY}`);
  const j = await r.json();
  const c = j.main.temp.toFixed(0);
  const f = (c * 9 / 5 + 32).toFixed(0);
  const desc = j.weather[0].description.replace(/\\b\\w/g, s => s.toUpperCase());
  weatherEl.textContent = `${c}°C | ${f}°F, ${desc}`;
}

async function updateFromGPS(){
  const data = window.locationData;
  if (!data || !data.latitude || !data.longitude) {
    placeEl.textContent = "Waiting for GPS...";
    return;
  }

  const lat = data.latitude;
  const lon = data.longitude;
  const label = await reverseGeocode(lat, lon);
  placeEl.textContent = label;
  fetchWeather(lat, lon);
}

setInterval(updateFromGPS, 10000); // update every 10 seconds
</script>
</body></html>
